// RUN: rel_opt.py %s | filecheck %s

builtin.module() {
  func.func() ["sym_name" = "map", "function_type" = !fun<[!stream.stream<!i32>], [!stream.stream<!i32>]>, "sym_visibility" = "public"] {
    ^0(%in : !stream.stream<!i32>):
    %res : !stream.stream<!i32> = stream.map(%in : !stream.stream<!i32>) {
    ^0(%val : !i32):
      %0 : !i32 = arith.constant() ["value" = 1 : !i32]
      %r : !i32 = arith.addi(%0 : !i32, %val : !i32)
      stream.yield(%r : !i32)
    }
    func.return(%res : !stream.stream<!i32>)
  }
}
